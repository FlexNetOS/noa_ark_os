# CRC Adaptation Rules

metadata:
  version: 1
  owners:
    primary: crc-governance
    storage_playbooks: storage-relocation
    documentation_playbooks: documentation-automation

adaptation_rules:
  # Naming conventions
  naming:
    convert_to_snake_case: true
    prefix_modules: "noa_"
    max_name_length: 50
    remove_prefixes:
      - "external_"
      - "lib_"
      - "util_"
  
  # Architecture alignment
  architecture:
    use_workspace_patterns: true
    enforce_layer_separation: true
    apply_security_model: true
    match_directory_structure: true
    module_organization:
      - "core -> noa_core"
      - "utils -> noa_utils"
      - "models -> noa_models"
  
  # Dependencies
  dependencies:
    remove_external: true
    use_embedded_runtimes: true
    vendor_if_necessary: true
    self_contained: true
    replacements:
      http:
        - "requests -> noa_http"
        - "urllib -> noa_http"
        - "axios -> noa_http"
        - "fetch -> noa_http"
      database:
        - "sqlite3 -> noa_storage::db"
        - "postgresql -> noa_storage::db"
        - "mysql -> noa_storage::db"
      async:
        - "asyncio -> noa_runtime::async"
        - "tokio -> noa_runtime::async"
      serialization:
        - "json -> noa_core::json"
        - "pickle -> noa_core::serialize"
  
  # Code quality
  quality:
    apply_formatter: true
    enforce_linting: true
    add_documentation: true
    generate_tests: true
    min_coverage: 80
    max_complexity: 10
    error_handling:
      rust: "Result<T, E>"
      python: "try/except with logging"
      go: "error return values"
  
  # Security
  security:
    scan_vulnerabilities: true
    check_licenses: true
    remove_secrets: true
    add_input_validation: true
    enforce_sandboxing: true
  
  # Performance
  performance:
    optimize_imports: true
    remove_dead_code: true
    cache_frequently_used: true
    add_profiling_hooks: false  # Only if needed
  
  # Testing
  testing:
    generate_unit_tests: true
    generate_integration_tests: true
    add_benchmarks: false
    mock_external_calls: true
    test_coverage_min: 80

  # Automation Guardrails
  automation:
    storage_playbooks:
      enforce_signed_runs: true
      require_dry_run: true
      relocation_window_minutes: 30
      max_parallel_jobs: 5
    documentation_playbooks:
      enforce_reviewers:
        - "tech-writer"
        - "product-owner"
      require_linked_ticket: true
      auto_changelog_update: true
    incident_recovery:
      validate_checkpoint_integrity: true
      require_post_incident_report: true
      enforce_rollforward_preference: true
