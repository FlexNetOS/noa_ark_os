{
  "format": "plain",
  "encoding": "base64",
  "original_path": "audit/publish_stub.py",
  "content": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiJNaW5pbWFsIGF1ZGl0IGJ1bmRsZSBwdWJsaXNoZXIgY29tcGF0aWJsZSB3aXRoIHZlcmlmeS5weS4iIiIKZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhbm5vdGF0aW9ucwoKaW1wb3J0IGFyZ3BhcnNlCmltcG9ydCBkYXRldGltZSBhcyBkdAppbXBvcnQgaGFzaGxpYgppbXBvcnQganNvbgppbXBvcnQgc2h1dGlsCmltcG9ydCBzdWJwcm9jZXNzCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aApmcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgTGlzdAoKCmRlZiBfdXRjX3RpbWVzdGFtcCgpIC0+IHN0cjoKICAgIHJldHVybiBkdC5kYXRldGltZS5ub3coZHQudGltZXpvbmUudXRjKS5yZXBsYWNlKG1pY3Jvc2Vjb25kPTApLmlzb2Zvcm1hdCgpLnJlcGxhY2UoIiswMDowMCIsICJaIikKCgpkZWYgX3NoYTI1NihwYXRoOiBQYXRoKSAtPiBzdHI6CiAgICBkaWdlc3QgPSBoYXNobGliLnNoYTI1NigpCiAgICB3aXRoIHBhdGgub3BlbigicmIiKSBhcyBoYW5kbGU6CiAgICAgICAgZm9yIGNodW5rIGluIGl0ZXIobGFtYmRhOiBoYW5kbGUucmVhZCgxMDI0ICogMTAyNCksIGIiIik6CiAgICAgICAgICAgIGRpZ2VzdC51cGRhdGUoY2h1bmspCiAgICByZXR1cm4gZGlnZXN0LmhleGRpZ2VzdCgpCgoKZGVmIF9naXRfaGVhZChyZXBvOiBQYXRoKSAtPiBzdHI6CiAgICByZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bigKICAgICAgICBbImdpdCIsICJyZXYtcGFyc2UiLCAiSEVBRCJdLAogICAgICAgIGN3ZD1yZXBvLAogICAgICAgIHRleHQ9VHJ1ZSwKICAgICAgICBjYXB0dXJlX291dHB1dD1UcnVlLAogICAgICAgIGNoZWNrPUZhbHNlLAogICAgKQogICAgaWYgcmVzdWx0LnJldHVybmNvZGUgIT0gMDoKICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoZiJnaXQgcmV2LXBhcnNlIGZhaWxlZDoge3Jlc3VsdC5zdGRlcnIuc3RyaXAoKX0iKQogICAgcmV0dXJuIHJlc3VsdC5zdGRvdXQuc3RyaXAoKQoKCmRlZiBfcGFyc2VfYXJncygpIC0+IGFyZ3BhcnNlLk5hbWVzcGFjZToKICAgIHBhcnNlciA9IGFyZ3BhcnNlLkFyZ3VtZW50UGFyc2VyKGRlc2NyaXB0aW9uPSJQdWJsaXNoIGEgdmVyaWZpYWJsZSBhdWRpdCBidW5kbGUgc3R1YiIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLXJlcG8iLCBkZWZhdWx0PSIuIiwgaGVscD0iUmVwb3NpdG9yeSByb290IGZvciBnaXQgbWV0YWRhdGEiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1hdWRpdC1kaXIiLCBkZWZhdWx0PSJhdWRpdCIsIGhlbHA9IkRpcmVjdG9yeSBjb250YWluaW5nIGF1ZGl0IGFydGlmYWN0cyIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KAogICAgICAgICItLWRyeS1ydW4iLAogICAgICAgIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsCiAgICAgICAgaGVscD0iUHJpbnQgYnVuZGxlIG1ldGFkYXRhIHdpdGhvdXQgd3JpdGluZyBmaWxlcyIsCiAgICApCiAgICByZXR1cm4gcGFyc2VyLnBhcnNlX2FyZ3MoKQoKCmRlZiBfY29sbGVjdF9zb3VyY2VzKGF1ZGl0X2RpcjogUGF0aCkgLT4gTGlzdFtQYXRoXToKICAgIGNhbmRpZGF0ZXMgPSBbCiAgICAgICAgYXVkaXRfZGlyIC8gImxlZGdlci5qc29ubCIsCiAgICAgICAgYXVkaXRfZGlyIC8gImxvY2FsX3BpcGVsaW5lX3N0YXR1cy5qc29uIiwKICAgICAgICBhdWRpdF9kaXIgLyAibWV0cmljcy90cnVzdF9zY29yZS5qc29uIiwKICAgIF0KICAgIHJldHVybiBbcGF0aCBmb3IgcGF0aCBpbiBjYW5kaWRhdGVzIGlmIHBhdGguZXhpc3RzKCldCgoKZGVmIG1haW4oKSAtPiBOb25lOgogICAgYXJncyA9IF9wYXJzZV9hcmdzKCkKICAgIHJlcG8gPSBQYXRoKGFyZ3MucmVwbykucmVzb2x2ZSgpCiAgICBhdWRpdF9kaXIgPSBQYXRoKGFyZ3MuYXVkaXRfZGlyKS5yZXNvbHZlKCkKICAgIGF1ZGl0X2Rpci5ta2RpcihwYXJlbnRzPVRydWUsIGV4aXN0X29rPVRydWUpCgogICAgdGltZXN0YW1wID0gX3V0Y190aW1lc3RhbXAoKQogICAgYnVuZGxlX2RpciA9IGF1ZGl0X2RpciAvIGYiYnVuZGxlLXt0aW1lc3RhbXAucmVwbGFjZSgnOicsICctJyl9IgogICAgbWFuaWZlc3RfcGF0aCA9IGJ1bmRsZV9kaXIgLyAiYnVuZGxlX21hbmlmZXN0Lmpzb24iCiAgICBzaWduYXR1cmVfcGF0aCA9IGJ1bmRsZV9kaXIgLyAic2lnbmF0dXJlLmpzb24iCiAgICBzb3VyY2VzID0gX2NvbGxlY3Rfc291cmNlcyhhdWRpdF9kaXIpCgogICAgaWYgbm90IHNvdXJjZXM6CiAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJObyBhdWRpdCBzb3VyY2VzIGF2YWlsYWJsZSB0byBwdWJsaXNoIikKCiAgICBidW5kbGVfZmlsZXM6IExpc3RbRGljdFtzdHIsIHN0cl1dID0gW10KICAgIGZvciBzcmMgaW4gc291cmNlczoKICAgICAgICByZWxhdGl2ZV9uYW1lID0gc3JjLm5hbWUKICAgICAgICBidW5kbGVfZmlsZXMuYXBwZW5kKHsKICAgICAgICAgICAgInBhdGgiOiByZWxhdGl2ZV9uYW1lLAogICAgICAgICAgICAic2l6ZSI6IHN0cihzcmMuc3RhdCgpLnN0X3NpemUpLAogICAgICAgICAgICAic2hhMjU2IjogX3NoYTI1NihzcmMpLAogICAgICAgIH0pCgogICAgbWFuaWZlc3QgPSB7CiAgICAgICAgImdlbmVyYXRlZF9hdCI6IHRpbWVzdGFtcCwKICAgICAgICAiY29tbWl0IjogX2dpdF9oZWFkKHJlcG8pLAogICAgICAgICJmaWxlcyI6IGJ1bmRsZV9maWxlcywKICAgIH0KCiAgICBpZiBhcmdzLmRyeV9ydW46CiAgICAgICAgcHJpbnQoanNvbi5kdW1wcyh7ImJ1bmRsZSI6IHN0cihidW5kbGVfZGlyKSwgKiptYW5pZmVzdH0sIGluZGVudD0yKSkKICAgICAgICBwcmludCgiRHJ5LXJ1bjogbm90IHdyaXRpbmcgYnVuZGxlIGFydGlmYWN0cyIpCiAgICAgICAgcmV0dXJuCgogICAgYnVuZGxlX2Rpci5ta2RpcihwYXJlbnRzPVRydWUsIGV4aXN0X29rPVRydWUpCiAgICBmb3Igc3JjIGluIHNvdXJjZXM6CiAgICAgICAgc2h1dGlsLmNvcHkyKHNyYywgYnVuZGxlX2RpciAvIHNyYy5uYW1lKQogICAgbWFuaWZlc3RfcGF0aC53cml0ZV90ZXh0KGpzb24uZHVtcHMobWFuaWZlc3QsIGluZGVudD0yKSArICJcbiIsIGVuY29kaW5nPSJ1dGYtOCIpCiAgICBzaWduYXR1cmUgPSB7InNpZ25hdHVyZSI6IF9zaGEyNTYobWFuaWZlc3RfcGF0aCl9CiAgICBzaWduYXR1cmVfcGF0aC53cml0ZV90ZXh0KGpzb24uZHVtcHMoc2lnbmF0dXJlLCBpbmRlbnQ9MikgKyAiXG4iLCBlbmNvZGluZz0idXRmLTgiKQoKICAgIGxlZGdlcl9wYXRoID0gYXVkaXRfZGlyIC8gImxlZGdlci5qc29ubCIKICAgIGxlZGdlcl9lbnRyeSA9IHsKICAgICAgICAidGltZXN0YW1wIjogdGltZXN0YW1wLAogICAgICAgICJidW5kbGUiOiBzdHIoYnVuZGxlX2Rpci5yZWxhdGl2ZV90byhyZXBvKSksCiAgICAgICAgInNpZ25hdHVyZSI6IHNpZ25hdHVyZVsic2lnbmF0dXJlIl0sCiAgICB9CiAgICB3aXRoIGxlZGdlcl9wYXRoLm9wZW4oImEiLCBlbmNvZGluZz0idXRmLTgiKSBhcyBoYW5kbGU6CiAgICAgICAgaGFuZGxlLndyaXRlKGpzb24uZHVtcHMobGVkZ2VyX2VudHJ5LCBzb3J0X2tleXM9VHJ1ZSkpCiAgICAgICAgaGFuZGxlLndyaXRlKCJcbiIpCiAgICBwcmludChmIvCfk6QgQXVkaXQgYnVuZGxlIGNyZWF0ZWQgYXQge2J1bmRsZV9kaXJ9IikKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigpCg=="
}
